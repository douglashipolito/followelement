/*! followelement 22-12-2014 */
!function(a){"use strict";function b(a,d){var f=this;if(!(f instanceof b)){var g=Object.create(b.prototype);return g.constructor.apply(g,arguments),g}v.push(f),f.instanceIndex=v.length-1,f.selector=a,f.element=[],f._debug=!1,f.currentVisibility="unknown",f.events={appear:{fn:null,count:0,action:"appeared"},disappear:{fn:null,count:0,action:"disappeared"},insert:{fn:null,count:0,action:"inserted"},remove:{fn:null,count:0,action:"removed"}},f.observer=e.call(f,a),d&&"function"==typeof d&&f.observer.observe("appear",d),"[object Object]"===Object.prototype.toString.call(d)&&(d.debug&&(f._debug=d.debug),d.context&&c.call(f,d.context),w.forEach.call(Object.keys(f.events),function(a){"function"==typeof d[a]&&f.observer.observe(a,d[a])}))}function c(a,b,c){var d=this;if(!a&&!d.context)throw new Error('You must define the "context" param');return"undefined"!=typeof a&&"undefined"!=typeof b&&c&&(d.context=a),a&&1!==a.nodeType&&(a=w.find(a)),!d.context&&a&&(d.context=a),d.context}function d(){var a=this,b=w.findAll("style."+q.call(a,a.selector));a.observer._MutationObserverInstance&&a.observer._MutationObserverInstance.disconnect(),w.forEach.call(b,function(a){a.parentElement.removeChild(a)}),a.observer.disconnected=!0}function e(a){var b,d=this;return b={appear:function(){k.call(this,a)},disappear:function(){m.call(d)},insert:function(a){a=c.call(d,a,"insert"),g.call(d,a)},remove:function(a){a=c.call(d,a,"remove"),l.call(d,a)}},{paused:!1,observe:function(a,c,e){d.events[a]&&(d.events[a].fn=c,b[a]&&b[a].call(d,e))}}}function f(a,b){var c,d=this;return d.observer.paused?!1:w.matches.call(a,d.selector)&&(c=d.events[b],"function"==typeof c.fn)?(a.__followElement||(d.element.push(a),a.__followElement=!0),c.fn.call(d,a),c.count++,d.currentVisibility=b,d._debug&&console.log(s(this.selector,b,"this element has "+c.action)),!0):!1}function g(a){var b=this,c=w.findAll(this.selector);w.forEach.call(c,function(a){f.apply(b,[a,"insert"])}),b.observer._MutationObserverInstance=j()?h.call(b,a):i.call(b,a)}function h(a){var b,c=this;return b=new u(function(a){a.forEach(function(a){w.forEach.call(a.addedNodes,function(a){1===a.nodeType&&f.apply(c,[a,"insert"])}),w.forEach.call(a.removedNodes,function(a){1===a.nodeType&&c.observer._checkRemove&&f.apply(c,[a,"remove"])})})}),b.observe(a,{childList:!0}),b}function i(a){var b=this,c=function(a){var c=a.target;f.apply(b,[c,"insert"])},d=function(a){var c=a.target;b.observer._checkRemove&&f.apply(b,[c,"remove"])};return b.observer._listeningDOMNodeInserted||(a.addEventListener("DOMNodeInserted",c),b.observer._listeningDOMNodeInserted=!0),b.observer._listeningDOMNodeRemoved||(a.addEventListener("DOMNodeRemoved",d),b.observer._listeningDOMNodeRemoved=!0),{disconnect:function(){a.removeEventListener("DOMNodeInserted",c,!1),a.removeEventListener("DOMNodeRemoved",d,!1)}}}function j(){var b=!!u;return/(iPhone|iPad|iPod)\sOS\s6/.test(a.navigator.userAgent)&&(b=!1),b}function k(a){var b=["animationstart","webkitAnimationStart","oanimationstart","MSAnimationStart"],c={keyframes:p(),selector:a,stylesClass:q.call(this,a),styles:r(a)},d=w.find("head"),e=function(a,b){var c=document.createElement(a);return b&&(b.className&&(c.className+=" "+b.className),b.content&&(c.innerText=b.content)),c};w.findAll("style.domnodeappear-keyframes").length||d.appendChild(e("style",{className:"domnodeappear-keyframes",content:c.keyframes})),w.findAll("style."+c.stylesClass).length||d.appendChild(e("style",{className:c.stylesClass,content:c.styles})),t||(w.forEach.call(b,function(a){document.addEventListener(a,function(a){var b=a.target;"elementAppeared"===a.animationName&&w.forEach.call(v,function(a){o(b)||f.apply(a,[b,"appear"]),w.matches.call(b,a.selector)&&a.observer._checkDisappear&&a.events.appear.count&&n.call(a,b)})},!1)}),t=!0)}function l(){var a=this;a.observer._checkRemove=!0}function m(){var a=this;a.observer._checkDisappear=!0}function n(a){var b,c=this,d=160;b=setTimeout(function e(){return o(a)?(clearTimeout(b),void f.apply(c,[a,"disappear"])):void setTimeout(e,d)},d)}function o(a){return null!==a&&0===a.offsetWidth&&0===a.offsetHeight||null===a.offsetParent}function p(){var a=" elementAppeared { from { outline: 1px solid transparent; }  to { outline: 0px solid transparent; } }",b="";return w.forEach.call(["@keyframes","@-moz-keyframes","@-webkit-keyframes","@-ms-keyframes","@-o-keyframes"],function(c){b+=c+a+" "}),b}function q(a){return a.replace(".","")+"-animation-"+this.instanceIndex}function r(a){return a+" { animation-name: elementAppeared;-webkit-animation-name: elementAppeared;animation-duration: 0.001s;-webkit-animation-duration: 0.001s; }"}function s(a,b,c){return"##VisibilityObserver##\n\nSelector = "+a+"\nAction = "+b+" \n\nMessage = "+c}var t,u=a.MutationObserver||a.WebKitMutationObserver||a.MozMutationObserver,v=[],w={find:function(a){return document.querySelector(a)},findAll:function(a){return document.querySelectorAll(a)},forEach:Array.prototype.forEach,matches:function(a){var b=Element.prototype,c=b.matches||b.matchesSelector||b.mozMatchesSelector||b.msMatchesSelector||b.oMatchesSelector||b.webkitMatchesSelector||function(a){for(var b=this,c=(b.parentNode||b.document).querySelectorAll(a),d=-1;c[++d]&&c[d]!=b;);return!!c[d]};return c.call(this,a)}};b.prototype={constructor:b,connect:function(a,b){return this.events[a]?(this.observer.observe(a,b),this):!1},disconnect:function(){return d.call(this),this},insert:function(a,b){return this.observer.observe("insert",a,b),this},remove:function(a,b){return this.observer.observe("remove",a,b),this},appear:function(a){return this.observer.observe("appear",a),this},disappear:function(a){return this.observer.observe("disappear",a),this},pause:function(){return this.observer.paused=!0,this},resume:function(){return this.observer.paused=!1,this},debug:function(){return this._debug=!this._debug,this},setContext:function(a,b){return c.call(this,a,b,!0),this}},b.version="0.0.0",a.followElement=b}(this);